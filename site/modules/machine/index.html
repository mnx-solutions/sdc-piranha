<div data-ng-switch="subview" class="row-fluid">

<div data-ng-switch-when="index" class="row-fluid"
     data-ng-controller="MachinesController">
    <div class="row-fluid">
        <div class="page-header hidden-phone">
            <h1><span data-translate>Compute</span>
                <small data-translate>A list of your computers and services</small>
            </h1>
            <img ng-hide="machines.final"
                 src="static/img/ajax-loader.gif"/>
        </div>

        <div class="row-fluid">
            <div class="row-fluid span12">
                <div class="span6">
                    <div class="btn-toolbar">

                        <div class="btn-group">
                            <button class="btn btn-success btn-small"
                                    ng-click="startAll();" data-ng-class="{disabled: !ischecked}" data-translate>Start
                            </button>
                            <button class="btn btn-warning btn-small"
                                    ng-click="stopAll();" data-ng-class="{disabled: !ischecked}" data-translate>Stop
                            </button>
                            <button class="btn btn-warning btn-small"
                                    ng-click="restartAll();" data-ng-class="{disabled: !ischecked}" data-translate>Reboot
                            </button>
                        </div>
                        <div class="btn-group">
                            <a href="#!/machine/add/"
                                    class="btn btn-primary btn-small" data-translate>
                                Add
                                new machine
                            </a>

                        </div>
                    </div>
                </div>

                <div class="span4 offset2">
                    <div class="btn-toolbar">
                        <input type="search" style="width: 100%;" class=""
                               data-ng-model="query" data-ng-change="search()"
                               placeholder="Search" name="search" id="search" data-translate="placeholder">
                    </div>
                </div>
            </div>

        </div>

        <div class="row-fluid">
            <table class="table table-striped table-hover table-condensed span12"
                   id="machinelist">
                <thead>
                <tr>
                    <td></td>
                    <td class="sortable" data-ng-click="sortBy('state')"
                        ng-switch on="sortIcon.state">
                        <span class="text" data-translate>State</span>
                        <i class="icon-arrow-up" ng-switch-when="up"/>
                        <i class="icon-arrow-down" ng-switch-when="down"/>
                    </td>
                    <td class="sortable" data-ng-click="sortBy('label')"
                        ng-switch on="sortIcon.label">
                        <span class="text" data-translate>Name</span>
                        <i class="icon-arrow-up" ng-switch-when="up"/>
                        <i class="icon-arrow-down" ng-switch-when="down"/>
                    </td>
                    <td class="sortable" data-ng-click="sortBy('dataset');"
                        ng-switch on="sortIcon.dataset">
                        <span class="text" data-translate>Dataset</span>
                        <i class="icon-arrow-up" ng-switch-when="up"/>
                        <i class="icon-arrow-down" ng-switch-when="down"/>
                    </td>
                    <td class="sortable" data-ng-click="sortBy('memory');"
                        ng-switch on="sortIcon.memory">
                        <span class="text" data-translate>Package</span>
                        <i class="icon-arrow-up" ng-switch-when="up"/>
                        <i class="icon-arrow-down" ng-switch-when="down"/>
                    </td>
                    <td data-translate>Network</td>
                    <td class="sortable hidden-phone" data-ng-click="sortBy('created');"
                        ng-switch on="sortIcon.created">
                        <span class="text" data-translate>Created</span>
                        <i class="icon-arrow-up" ng-switch-when="up"/>
                        <i class="icon-arrow-down" ng-switch-when="down"/>
                    </td>
                </tr>
                </thead>

                <tbody>
                <tr data-ng-repeat="machine in pagedMachines[currentPage] | orderBy:sortingOrder:reverse"
                    data-ng-class-odd="odd" ng-class-even="even">
                    <td><input type="checkbox" ng:model="checked[machine.id]" ng-click="showGroupActions();" ng-checked="checked[machine.id]"></td>
                    <td>
                        <machine-status machine="machine"/>
                    </td>
                    <td>
                        <a href="#!/machine/details/{{machine.id}}">{{machine.label}}</a>
                    </td>
                    <td ng-init="dset = datasetInfo(machine);"> {{dset.name}} ({{dset.os}})</td>
                    <td ng-init="pack = packageInfo(machine);">
                        <span data-translate> Memory: {{pack.memory | sizeFormat}}</span>
                        <span data-translate> Disk: {{pack.disk | sizeFormat}}</span>
                        <span data-translate> VCPUs: {{pack.vcpus}}</span></td>
                    <td>
                    <span data-ng-repeat="ip in machine.ips">
                        {{ ip }}
                    </span>
                    </td>
                    <td class="hidden-phone">{{machine.created | fromNow}}</td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="row-fluid">
            <div class="pagination pagination-small pagination-centered span12">
                <ul>
                    <li data-ng-class="{disabled: currentPage == 0}">
                        <a href ng-click="prevPage()" data-translate>« Prev</a>
                    </li>
                    <li data-ng-repeat="n in range()"
                        data-ng-class="{active: n == currentPage}"
                        data-ng-click="setPage()">
                        <a href ng-bind="n + 1">1</a>
                    </li>
                    <li data-ng-class="{disabled: currentPage == pagedMachines.length - 1}">
                        <a href ng-click="nextPage()" data-translate>Next »</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div data-ng-switch-when="details" class="row-fluid"
     data-ng-controller="MachineController">
    <div class="page-header">
        <h1><span data-translate>Machine</span>
            <small>{{selectedmachine.name}}</small>
        </h1>
    </div>

    <!-div class="row-fluid"-->
    <div class="span12">
        <div class="btn-toolbar">
            <div class="btn-group">
                <button ng-disabled="selectedmachine.job.running || selectedmachine.state != 'stopped'"
                        class="btn btn-primary"
                        ng-click="clickStart(selectedmachine.id)" data-translate>Start
                </button>
                <button ng-disabled="selectedmachine.job.running || selectedmachine.state != 'running'"
                        class="btn btn-warning "
                        ng-click="clickStop(selectedmachine.id)" data-translate>Stop
                </button>
                <button ng-disabled="selectedmachine.job.running || !selectedmachine"
                        class="btn btn-warning"
                        ng-click="clickReboot(selectedmachine.id);" data-translate>Reboot
                </button>
            </div>
            <div class="btn-group">
                <button ng-disabled="selectedmachine.job.running || selectedmachine.state != 'stopped'"
                        class="btn btn-danger"
                        ng-click="clickDelete(selectedmachine.id);" data-translate>Delete
                </button>
            </div>
        </div>
    </div>

    <div class="span6">
        <table class="table table-condensed machinedetails">
            <caption><h4 class="pull-left" data-translate>Overview</h4></caption>

            <tr>
                <td class="key" data-translate>Name</td>
                <td class="value">{{selectedmachine.name}}</td>
            </tr>
            <tr>
                <td class="key" data-translate>uuid</td>
                <td class="value">
                    <small>{{selectedmachine.id}}</small>
                </td>
            </tr>

            <tr>
                <td class="key" data-translate>State</td>
                <td class="value">
                    <machine-status machine="selectedmachine"/>
                </td>
            </tr>

            <tr>
                <td class="key" data-translate>IP(s)</td>
                <td class="value"><span
                        data-ng-repeat="ip in selectedmachine.ips">{{ ip }} </br></span>
                </td>
            </tr>

            <tr>
                <td class="key" data-translate>Created</td>
                <td class="value">{{selectedmachine.created |
                    date:'yyyy-MM-dd HH:mm:ss Z'}}
                </td>
            </tr>

        </table>
        <br>
    </div>

    <div class="span6" ng-show="{{selectedmachine.metadata.credentials}}">
        <h4 data-translate>Credentials</h4>
        <table class="table table-striped text-medium"
               style="width:470px">
            <thead>
            <tr>
                <th style="width:115px !important" data-translate>Username</th>
                <th style="width:155px !important" data-translate>Password</th>
                <th>&nbsp;</th>
            </tr>
            </thead>
            <tbody>
            <tr data-ng-repeat="(key,val) in selectedmachine.metadata.credentials">
                <td>{{key}}</td>
                <td><span id="label-1">************</span><span
                        id="pwd-1" class="none">{{val}}</span></td>
                <td nowrap><a rel="1" class="show-password" data-translate>[ Show ]</a></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="span5">
        <h4><span data-translate>Resize</span><br>
            <small data-translate>Please note, that it may not always be
                possible to resize based on the constraints of
                your current server location.
            </small>
        </h4>

        <p data-translate>Current Size: {{selectedmachine.memory | sizeFormat}} of RAM</p>

        <form class="form-horisontal inline-form">
            <div class="control-group">
                <label class="control-label" data-translate>New
                    Package</label>

                <div class="controls input-append">

                    <select name="resize"
                            data-ng-model="resize"
                            data-ng-options="package.name for package in packages"></select>

                    <button class="btn btn-primary" type="submit"
                            ng-click="clickResize(selectedmachine.id)" data-translate>
                        Resize
                    </button>

                </div>
            </div>
        </form>
    </div>

    <div class="span5" ng-show="tagcloud">
        <h4 data-translate>Tags</h4>

        <small data-translate>Tags are metadata stored as key-value pairs to
            make it easier for you to find, sort, and identify
            your machines.
        </small>


        <div id="tagcloud">
            <div class="control-group"
                data-ng-repeat="(key, o) in tagcloud" data-ng-class="{error: o.conflict}">
                <div class="controls">
                    <input type="text" class="tag-key span3" placeholder="Key"
                           data-ng-model="o.key" data-translate="placeholder">
                    <input type="text" class="tag-value span3" placeholder="Value"
                           data-ng-model="o.val">
                                <span class="icon-trash"
                                      style="margin-top:-5px" data-ng-click="removeTag(key)" data-translate="placeholder"></span>
                </div>
            </div>
        </div>
        <button class="btn btn-primary" data-ng-click="clickSaveTags(selectedmachine.id)" data-translate>Save</button>
    </div>
</div>

<div data-ng-switch-when="provision"
     data-ng-controller="ProvisionController"
     class="row-fluid">

    <div class="page-header">
        <h1><span data-translate>Provision</span>
            <small data-translate>Provision a new machine</small>
        </h1>
    </div>

    <div class="span4">
        <form class="form-horisontal inline-form">

            <div class="controls">
                <label class="control-label" for="machinename" data-translate>Machine
                    name:</label>
                <input id="machinename" type="text" placeholder="Name"
                       data-ng-model="data.name" data-translate="placeholder"><br/>

                <label class="control-label"
                       for="datacenter" data-translate>Datacenter:</label>
                <select id="datacenter"  data-ng-model="data.datacenter"
                        data-ng-options="key as key for (key, value) in datacenters"></select>

                <label class="control-label" for="dataset" data-translate>Image
                    (version):</label>
                <select id="dataset" data-ng-model="data.dataset"
                        data-ng-options="dataset.name+' ('+dataset.version+')' group by dataset.name for dataset in datasets"></select>

                <label class="control-label" for="package" data-translate>Package:</label>
                <select id="package" data-ng-model="data.sdcpackage"
                        data-ng-options="package.name for package in packages"></select><br/>

                <button href="#myModal" role="button" data-toggle="modal"
                        class="btn btn-primary"
                        ng-click="clickProvision();" data-translate>Add
                    new machine
                </button>
            </div>
        </form>
    </div>
</div>
</div>
