<div class="container-fluid container-position" data-ng-controller="Machine.ProvisionController">
    <div data-breadcrumbs></div>
    <div class="loading-large span12" data-ng-show="loading"></div>
    <div class="" data-ng-hide="loading">
        <div class="container-min-width" data-ng-show="keys.length">
            <h3 class="page-title no-breadcrumb-line container-min-width" data-translate>Create Instance</h3>
            <div class="wizard-steps">
                <div class="firststep active-step">
                    <p data-ng-show="currentSlidePageIndex >= 1"><span class="breadcrumb current-step" data-target="#provisionCarousel" data-ng-click="reconfigure(0)" data-slide-to="0">Choose Image</span></p>
                    <p data-ng-hide="currentSlidePageIndex >= 1">Choose Image</p>
                </div>
                <div>
                    <p data-ng-show="currentSlidePageIndex >= 2"><span class="breadcrumb current-step" data-target="#provisionCarousel" data-ng-click="reconfigure(1)" data-slide-to="1">Select Package</span></p>
                    <p data-ng-hide="currentSlidePageIndex >= 2">Select Package</p>
                </div>
                <div><p class="current-step">Review</p></div>
                <div><p class="laststep"></p></div>
            </div>
            <div class="row-fluid carousel-container">
                <div class="span8 provisioning-carousel-span">
                    <div id="provisionCarousel" class="carousel slide dpl-inline">
                        <div class="carousel-inner provisioning-carousel-inner-box advanced-table" data-ng-class="{'loading-medium':reloading}">
                            <div class="active item outer-provisioning-item">
                                <div class="container-min-width wizard-first-step">
                                    <div class="dpl-inline">
                                        <input type="text" class="filter-field filter-images" placeholder="Search image" data-ng-model="searchText" data-translate="placeholder" />
                                    </div>
                                    <span class="select-name">
                                            Data Center:
                                        </span>
                                    <div class="btn-group">
                                        <button class="btn datacenter-select dd-fixed-width" data-ng-show="data.datacenter" data-toggle="dropdown">{{data.datacenter}}</button>
                                        <button id="button-select-datacenter" class="btn dropdown-toggle datacenter-select" data-toggle="dropdown">
                                            <span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu">
                                            <li data-ng-repeat="datacenter in datacenters">
                                                <a data-ng-click="selectDatacenter(datacenter.name)">{{datacenter.name}}</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <span class="select-name">
                                            OS:
                                        </span>
                                    <div class="btn-group hidden-phone"
                                         data-html="true"
                                         data-original-title="Filter by operating system">
                                        <button class="btn datacenter-select dd-fixed-width" data-ng-show="data.opsys" data-toggle="dropdown">{{data.opsys}}</button>
                                        <button id="button-select-os" class="btn dropdown-toggle datacenter-select" data-toggle="dropdown">
                                            <span class="caret"></span>
                                        </button>
                                        <ul class="dropdown-menu">
                                            <li data-ng-repeat="opsys in operating_systems">
                                                <a data-ng-click="selectOpsys(opsys) | orderBy:'toString()'">{{opsys}}</a>
                                            </li>
                                        </ul>
                                    </div>

                                    <div class="hotlinks pull-right">
                                        <a href="#!/compute/create/simple" data-ng-click="clickBackToQuickStart()">Back to Quick Start</a>
                                        <span data-ng-show="features.imageUse != 'disabled'">
                                            | <a href="#!/compute/create" data-ng-show="instanceType != 'Public'" data-ng-click="selectInstanceType('Public');">Public Images</a>
                                        <a href="#!/compute/create/custom" data-ng-show="instanceType != 'Saved'" data-ng-click="selectInstanceType('Saved');">Saved Images</a>
                                        </span>
                                    </div>
                                </div>
                                <div class="advanced-table tooltip-hover">
                                    <div data-ng-show="(datasets | filter:filterDatasetsByVisibility).length == 0 && !reloading" class="font-size16">
                                        No {{instanceType | lowercase}} images in this data center.
                                    </div>
                                    <div data-ng-hide="reloading" data-ng-repeat="dataset in (datasets | orderBy:['type','name']) | filter:filterDatasets | filter:filterDatasetsByOS | filter:filterDatasetsByVisibility">
                                        <div class="advanced-instance-box small-icon"
                                             data-ng-class="selectedVersions[dataset.name].name || dataset.name | logo"
                                             data-toggle="tooltip"
                                             data-tooltip-text="{{selectedVersions[dataset.name].description || dataset.description}}"
                                             data-ng-click="selectDataset((selectedVersions[dataset.name].id || dataset.id))">
                                            <div class="advanced-instance-title">
                                                <p>{{selectedVersions[dataset.name].name || dataset.name}}</p>
                                            </div>
                                            <div class="advanced-instance-description">
                                                <p>{{selectedVersions[dataset.name].description || dataset.description}}</p>
                                            </div>
                                            <div class="advanced-instance-btn-block">
                                                <button type="button"
                                                   id="dataset-{{dataset.id}}"
                                                   name="dataset"
                                                   value="{{selectedVersions[dataset.name].id || dataset.id}}"
                                                   data-ng-checked="selectedDataset.id == dataset.id"
                                                        class="btn advaced-instance-btn pull-right"><b>Select</b>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="item outer-provisioning-item">
                                <div class="item provisioning-item header row-fluid">
                                        <div data-ng-show="selectedPackageInfo" class="preselected pull-right">
                                            <div class="info small-icon"
                                                 data-ng-class="selectedVersions[selectedDataset.name].name || selectedDataset.name | logo">
                                                <p>IMAGE:</p><button class="btn small-btn effect-orange-button" data-ng-click="reconfigure(0)" id="prev" data-slide="prev">Change</button>
                                                <span><h2>{{selectedDataset.name}}</h2></span>
                                                <div class="dataset-desc crop text-wrap">{{selectedDataset.description}}</div>

                                                <p data-ng-show="manyVersions[selectedDataset.name]">INSTANCE VERSION:</p>
                                                <div class="text-small image-container" data-ng-show="manyVersions[selectedDataset.name]">
                                                    <div class="btn-group pull-left">
                                                        <button class="btn datacenter-select dd-fixed-width" data-ng-show="selectedVersions[selectedDataset.name]" data-toggle="dropdown">
                                                            {{selectedVersions[selectedDataset.name].version}}
                                                        </button>

                                                        <button class="btn datacenter-select dropdown-toggle" data-toggle="dropdown">
                                                                <span class="caret"></span>
                                                        </button>

                                                        <ul class="dropdown-menu dd-fixed-width">
                                                            <li data-ng-repeat="version in versions[selectedDataset.name]">
                                                                <a data-ng-click="selectVersion(selectedDataset.name, version)">{{version.version}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="dataset-cost cost">
                                                    <p>EST. MONTHLY COST:</p>
                                                    <h3>${{selectedPackageInfo.full_price_month || selectedPackageInfo.price_month}}</h3>
                                                </div>
                                                <div class="pull-right">
                                                    <button type="button" id="button-review" class="btn orange review-btn" data-ng-click="reviewPage()">Review</button>
                                                </div>
                                            </div>
                                        </div>
                                    <div class="filter-container">
                                        Filter:
                                        <div class="btn-group btn-group-filter">
                                            <button class="btn datacenter-select filter-select" data-toggle="dropdown">
                                                {{filterProperty | uppercase}}
                                            </button>

                                            <button class="btn datacenter-select dropdown-toggle" data-toggle="dropdown">
                                                <span class="caret"></span>
                                            </button>

                                            <ul class="dropdown-menu dd-fixed-width">
                                                <li data-ng-repeat="prop in filterProps">
                                                    <label class="filter-value">
                                                        {{prop | uppercase}}
                                                        <input type="radio"
                                                               class="filter-radio"
                                                               name="filterProperty"
                                                               data-ng-model="$parent.filterProperty"
                                                               data-ng-change="$parent.onFilterChange(prop)"
                                                               value="{{prop}}" />
                                                    </label>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="btn-group btn-group-filter" data-ng-show="filterProperty != 'No filter'">
                                            <button class="btn datacenter-select filter-select" data-toggle="dropdown">
                                                {{ formatFilterValue(filterPropertyValue) }}
                                            </button>

                                            <button class="btn datacenter-select dropdown-toggle" data-toggle="dropdown">
                                                <span class="caret"></span>
                                            </button>

                                            <ul class="dropdown-menu dd-fixed-width">
                                                <li data-ng-repeat="prop in filterValues[filterProperty]">
                                                    <label class="filter-value">
                                                        {{ formatFilterValue(prop) }}
                                                        <input type="radio"
                                                               class="filter-radio"
                                                               name="filterPropertyValue"
                                                               data-ng-model="$parent.filterPropertyValue"
                                                               data-ng-change="$parent.onFilterChange()"
                                                               value="{{prop}}" />
                                                    </label>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="">
                                        <div class="accordion-package-title">
                                            <span class="span-name">NAME</span>
                                            <span class="span-specification">SPECIFICATION</span>
                                            <span class="span-price">PRICE</span>
                                        </div>
                                        <div class="accordion accordion-package-select" id="packagesAccordion">
                                            <div class="accordion-group" data-ng-repeat="packageType in packageTypes | filter:filterPackageTypes(datasetType)">
                                                <div class="accordion-heading">
                                                    <a class="accordion-toggle collapsed toggle-icon" data-toggle="collapse" data-parent="#packagesAccordion"
                                                       href="#collapse_{{$index}}" data-ng-click="changeSelectedPackage($event, packageType)" data-ng-class="{'filter-on': filterProperty != 'No filter'}">
                                                        {{packageType}}
                                                        <span class="accordion-package-count">{{(packages | filter:filterPackagesByProp | filter:filterPackages(packageType)).length}}</span>
                                                    </a>
                                                </div>
                                                <div id="collapse_{{$index}}" class="accordion-body collapse">
                                                    <div class="accordion-inner">
                                                        <div class="package-info" data-ng-repeat="package in (packages | filter:filterPackagesByProp | orderBy:sortPackages) | filter:filterPackages(packageType)"
                                                             data-ng-click="selectPackage(package.id)"
                                                             data-ng-checked="selectedPackage == package.id"
                                                             data-ng-class="{active: selectedPackage == package.id}">
                                                            <div class="short-name">{{package.short_name}}</div>
                                                            <div class="memory"><p data-ng-show="package.memory < 1024">Micro </p> {{package.memory | sizeFormat}} RAM</div>
                                                            <div class="cpu">{{package.vcpus}} vCPUs</div>
                                                            <div class="disk">{{package.disk | sizeFormat}} Disk</div>
                                                            <div class="price">${{package.full_price || package.price}} <p data-translate>per hour</p></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="item outer-provisioning-item">
                                <div class="item-scrolling">
                                    <div class="review">
                                        <table>
                                            <td>
                                                <div class="left small-icon"
                                                     data-ng-class="selectedVersions[selectedDataset.name].name || selectedDataset.name | logo">
                                                    <p>IMAGE:</p><button class="btn small-btn effect-orange-button" data-ng-click="reconfigure(0)" data-target="#provisionCarousel" data-slide-to="0">Change</button>
                                                    <span><h2>{{selectedDataset.name}}</h2></span>
                                                    <div class="dataset-desc crop text-wrap">{{selectedDataset.description}}</div>

                                                    <p data-ng-show="manyVersions[selectedDataset.name]">INSTANCE VERSION:</p>
                                                    <div class="text-small image-container" data-ng-show="manyVersions[selectedDataset.name]">
                                                        <div class="btn-group pull-left">
                                                            <button class="btn datacenter-select dd-fixed-width" data-ng-show="selectedVersions[selectedDataset.name]" data-toggle="dropdown">
                                                                {{selectedVersions[selectedDataset.name].version}}
                                                            </button>

                                                            <button class="btn datacenter-select dropdown-toggle" data-toggle="dropdown">
                                                                <span class="caret"></span>
                                                            </button>

                                                            <ul class="dropdown-menu dd-fixed-width">
                                                                <li data-ng-repeat="version in versions[selectedDataset.name]">
                                                                    <a data-ng-click="selectVersion(selectedDataset.name, version)">
                                                                        {{version.version}}
                                                                    </a>
                                                                </li>
                                                             </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="separator">
                                                <div class="center">
                                                    <p>PACKAGE:</p><button class="btn small-btn effect-orange-button" data-ng-click="reconfigure(1)" data-slide="prev">Change</button>
                                                    <div class="package">
                                                        <div class="name">Configuration</div>
                                                        <div class="value">{{selectedPackageInfo.short_name}}</div>
                                                    </div>
                                                    <div class="package">
                                                        <div class="name">Memory</div>
                                                        <div class="value">{{selectedPackageInfo.memory | sizeFormat}}</div>
                                                    </div>
                                                    <div class="package">
                                                        <div class="name">Disk</div>
                                                        <div class="value">{{selectedPackageInfo.disk | sizeFormat}}</div>
                                                    </div>
                                                    <div class="package">
                                                        <div class="name">vCPUs</div>
                                                        <div class="value">{{selectedPackageInfo.vcpus}} vCPUs</div>
                                                    </div>
                                                    <div class="package">
                                                        <div class="name">DataCenter</div>
                                                        <div class="value">{{data.datacenter}} </div>
                                                    </div>
                                                    <div class="cost">
                                                        <p>COST:</p>
                                                        <div class="dataset-cost">
                                                            <h3>${{selectedPackageInfo.full_price || selectedPackageInfo.price}}</h3>
                                                            <p class="small-text-info">per hour</p>
                                                        </div>
                                                        <div class="dataset-cost">
                                                            <h3>${{selectedPackageInfo.full_price_month || selectedPackageInfo.price_month}}</h3>
                                                            <p class="small-text-info">est. monthly</p>
                                                        </div>
                                                     </div>
                                                </div>
                                            </td>
                                            <td>
                                                <form name="provisionForm" id="provision-form">
                                                    <div class="right">
                                                        <p class="title-box-3">OPTIONAL SETTINGS:</p>
                                                        <span><h2>Name Instance</h2><p> (Optional)</p></span>
                                                        <input name="machineName"
                                                               type="text"
                                                               data-ng-model="data.name"
                                                               data-machine-name
                                                               data-machine-unique
                                                               class="instance-name-input"/>
                                                        <div class="error"
                                                            data-ng-show="provisionForm.machineName.$error.machineName"
                                                            data-translate>
                                                            Machine name can contain only letters, digits and signs like '.' and '-'.
                                                        </div>

                                                        <div class="error"
                                                             data-ng-show="provisionForm.machineName.$error.machineUnique"
                                                             data-translate>
                                                            Machine name is already in use
                                                        </div>
                                                        <div><h2>Networks</h2></div>
                                                        <div class="networks-box-3">
                                                            <label data-ng-repeat="network in networks">
                                                                <div class="checker" data-ng-class="{hover:show}" data-ng-mouseenter="show = true" data-ng-mouseleave="show = false">
                                                                    <span data-ng-class="{checked: network.active}">
                                                                         <input data-ng-click="selectNetworkCheckbox(network.id)" type="checkbox"
                                                                                value="{{network.id}}"
                                                                                name="{{network.name}}"
                                                                                data-ng-model="selectedNetworkId"
                                                                                data-ng-disabled="selectedNetworks.length == 2 && selectedNetworks.indexOf(network.id) == -1"/>
                                                                    </span>
                                                                </div>
                                                                <span data-ng-class="{disabledNetworkSelection: (selectedNetworks.length == 2 && selectedNetworks.indexOf(network.id) == -1)}">{{network.name}}</span><br />
                                                            </label>
                                                         </div>
                                                        <div><h2>Tags</h2></div>
                                                        <p class="tags-text-p">Tags are metadata stored as key-value pairs to make it easier for you to find, sort, and identify your instances.</p>
                                                        <div class="create-tags ci-tags"
                                                             data-machine-collection
                                                             data-collection="tags"
                                                             data-collection-name="'tags'"
                                                             data-review="true">
                                                        </div>
                                                        <div class="metadata-section" data-ng-show="instanceMetadataEnabled">
                                                            <div><h2>Metadata</h2></div>
                                                            <div class="create-mdata ci-tags"
                                                                 data-machine-collection
                                                                 data-collection="metadata"
                                                                 data-collection-name="'metadata'"
                                                                 data-review="true">
                                                            </div>
                                                        </div>
                                                        <button id="button-create" class="btn orange create-instance-btn-pos pull-right"
                                                                data-ng-disabled="provisionForm.$invalid"
                                                                data-ng-click="clickProvision()"
                                                                data-translate>Create instance
                                                        </button>
                                                    </div>
                                                </form>
                                            </td>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="dpl-inline pull-right">
                            <button class="btn grey effect-orange-button btn-back-quick" data-ng-click="clickBackToQuickStart()"><b>Back to Quick Start</b></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div data-ng-show="keys.length == 0" class="container-min-width">
        <h4>Hello there!</h4>
        <div data-translate>I see you have no SSH keys configured.</div>
        <div class="pull-left" style="margin-top: 20px">
            <a href="#!/account/ssh" class="btn orange align-text-btn">Add a SSH key</a>
        </div>
    </div>
</div>
