<div class="container" data-ng-controller="elb.EditController">
    <div data-notification></div>
    <form name="editForm">
        <ul class="breadcrumb">
            <li class="ng-scope">
                <a href="#!/elb" class="ng-binding">
                    <span class="ng-scope ng-binding" data-translate>Load Balancers</span>
                </a>
                <span class="divider">/</span>
            </li>
            <li class="ng-scope active">
                <span class="ng-binding" data-ng-show="balancerId" data-translate>Edit Load Balancer</span>
                <span class="ng-binding" data-ng-show="!balancerId" data-translate>Create Load Balancer</span>
            </li>
        </ul>
        <div class="page-header">
            <h1 class="pull-left" data-ng-show="balancerId" data-translate>Edit Load Balancer</h1>
            <h1 class="pull-left" data-ng-hide="balancerId" data-translate>Create Load Balancer</h1>
            <div class="clearfix"></div>
        </div>
        <div class="loading-large" data-ng-hide="allLoading"></div>
        <div class="row-fluid lb-edit" data-ng-show="allLoading">
            <div class="span5">
                <div class="">
                    <span class="span2 lb-label" data-translate>Name</span>
                <span class="span9 name-input">
                    <input type="text" required data-ng-model="server.name"/>
                </span>
                </div>
                <div data-ng-show="balancerId">
                    <span class="span2" data-translate>IP</span>
                <span class="span9" style="padding-left: 37px;">
                    {{server.host}}
                </span>
                </div>
                <div>
                    <span class="span3 lb-label" data-translate>Protocol</span>
                    <div class="btn-group tooltip-hover span3 dd_margin"
                         data-toggle="tooltip"
                         data-placement="bottom"
                         style="margin-left: 13px;">
                        <label class="btn dd_btn">{{protocolSelected.name}}</label>
                        <button class="btn dropdown-toggle" data-toggle="dropdown">
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            <li data-ng-repeat="protocol in protocols">
                                <a data-ng-click="protocolSelect(protocol.value)">{{protocol.name}}</a>
                            </li>
                        </ul>
                    <span class="upload_btn" data-ng-show="protocolSelected.name == 'HTTPS'">
                        <span data-cert-upload model="server.certificate"></span>
                    </span>
                    </div>
                </div>
                <div class="clearfix"></div>
                <div>
                    <span class="lb-label" data-translate>External port&nbsp;</span>
                <span class="port-input">
                    <input name="fromPort" type="text" required data-ng-model="server.fromPort"
                           data-ng-change="validatePort('fromPort', 1, 65535)"/>
                </span>
                </div>
                <div style="margin-top: -10px;">
                    <span class="lb-label" data-translate>Internal port &nbsp;</span>
                <span class="port-input">
                    <input name="toPort" type="text" required data-ng-model="server.toPort"
                           data-ng-change="validatePort('toPort', 1, 65535)"/>
                </span>
                </div>
                <div class="clearfix"></div>
                <div class="lb-line"></div>
                <p class="span12 pull-left" style="margin: 0 0 -10px 0;" data-translate>Health Check configuration</p>

                <div class="clearfix"></div>
                <div style="margin-top: 10px;">
                    <span class="span3 lb-label" data-translate>URL</span>
                <span class="span3">
                    <input type="text" data-ng-model="server.health.url" class="url-input"/>
                </span>
                    <span class="span3 lb-label" style="margin: 0 0 0 20px;" data-translate>Timeout</span>

                    <div class="btn-group tooltip-hover span3 dd_margin"
                         data-toggle="tooltip"
                         style="margin-left: -27px;"
                         data-placement="bottom">
                        <label class="btn dd_btn">{{server.health.timeout}} sec</label>
                        <button class="btn dropdown-toggle" data-toggle="dropdown">
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            <li data-ng-repeat="timeout in timeouts">
                                <a data-ng-click="timeoutSelect(timeout)">{{timeout}} sec</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="clearfix"></div>
                <div>
                    <span class="span3" style="line-height: 30px;" data-translate>HC interval</span>
                    <div class="btn-group tooltip-hover span3 dd_margin"
                         data-toggle="tooltip"
                         data-placement="bottom">
                        <label class="btn dd_btn">{{server.health.delay}} mins</label>
                        <button class="btn dropdown-toggle" data-toggle="dropdown">
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            <li data-ng-repeat="hcDelay in hcDelays">
                                <a data-ng-click="hcDelaySelect(hcDelay)">{{hcDelay}} mins</a>
                            </li>
                        </ul>
                    </div>
                    <span class="span3" style="line-height: 15px;margin-left: 28px;" data-translate>Failure Threshold</span>
                <span class="span2 port-input">
                    <input name="failThreshold" type="text" class="clb_input"
                           data-ng-model="server.health.failThreshold"
                           data-ng-change="validatePort('failThreshold', 1)"/>
                </span>
                </div>
            </div>

            <div class="span7 table_overflow" style="border-left: 2px solid #ececec;padding-left: 20px;margin-left: 0;">
                <table class="table table-striped table-bordered table-hover table-full-width">
                    <thead>
                    <tr>
                        <th class="hidden-480"></th>
                        <th class="table-title sortable">
                            <div class="block" data-translate>Machine name</div>
                        </th>
                        <th class="table-title sortable">
                            <div class="block" data-translate>Data Center</div>
                        </th>
                        <th class="table-title sortable">
                            <div class="block" data-translate>Creation Date</div>
                        </th>
                        <th class="table-title sortable">
                            <div class="block" data-translate>Load Balancer</div>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr data-ng-repeat="machine in machines">
                        <td width="10"><input type="checkbox" class="group-checkable" data-ng-model="machine.selected">
                        </td>
                        <td title="{{machine.name}}"><a href="#!/compute/instance/{{machine.id}}">{{machine.name}}</a>
                        </td>
                        <td title="{{machine.datacenter}}">{{machine.datacenter}}</td>
                        <td title="{{machine.created | dateTime:'YYYY-MM-DD'}}">{{machine.created | dateTime:'YYYY-MM-DD'}}</td>
                        <td>
                            <span title="{{balancer.name}}" data-ng-repeat="balancer in machine.balancers">{{balancer.name}}<br></span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

    <span class="span12" data-ng-show="allLoading">
        <p class="logo_riverbed pull-left" data-translate>Powered by</p>
        <button data-ng-disabled="!editForm.$valid || saving" data-ng-click="save()"
                class="btn btn-joyent-blue pull-right" data-translate="" style="margin: -20px 20px 30px 10px;">
            <span class="ng-scope" data-translate>Save</span>
        </button>
        <button data-ng-show="balancerId" data-ng-disabled="!editForm.$valid" data-ng-click="delete()"
                class="btn btn-joyent-blue pull-right" data-translate="" style="margin: -20px 0 30px 10px;">
            <span class="ng-scope" data-translate>Delete</span>
        </button>
        <div class="pull-right loading-medium"
             style="width:30px; height:30px;min-width:30px;min-height:30px;margin-top:-20px"
             data-ng-show="saving"></div>
    </span>

    </form>
</div>